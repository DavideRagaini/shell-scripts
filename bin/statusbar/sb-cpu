#!/bin/sh

case "$BLOCK_BUTTON" in
    1) notify-send "üñ• CPU hogs" "$(ps axch -o cmd:15,%cpu --sort=-%cpu | head)" ;;
    2) notify-send "üñ• CPU hogs" "$(ps axch -o cmd:15,%cpu --sort=-%cpu | head)" ;;
    3) notify-send "Currently in:" "$(sudo tlp-stat -s | grep Mode | sed 's/^.*=//g')" ;;
    6) "$TERMINAL" -e "$EDITOR" "$0" ;;
esac

LOAD="$(cut -d ' ' -f1-3 /proc/loadavg)"
CORES=$(lscpu | awk '/^.*On-line CPU\(s\)/ {sub(",","-",$4); print $4}')
R=$(shuf -i "$CORES" -n 1)
CLOCK="$(cat /sys/devices/system/cpu/cpu"$R"/cpufreq/scaling_cur_freq)"
TEMP="$(cat /sys/class/thermal/thermal_zone2/temp | cut -c -2)"
[ "$CLOCK" -lt 1000000 ] && N=3
CLOCK="$(echo "$CLOCK" | cut -c -${N:-4})"
# [ "$(doas tlp-stat -s | awk '/Mode/ {print $3}')" = "AC" ] && FIRE=" ÔÅ≠"
printf "%s %d@%s %dÔ®É]" "$LOAD" "$R" "$CLOCK" "$TEMP"
