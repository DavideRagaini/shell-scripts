#!/bin/sh

ALARM="${XDG_VIDEOS_DIR:-$HOME/Storage/Videos}/alarm"
MIMETYPE="$(file -Lb --mime-type "$ALARM" | cut -f1 -d'/')"
TIME="$(date '+%H:%M')"

notify() {
    echo "Alarm is ringing: $TIME"
    notify-send -u critical "Alarm is ringing" "$TIME"
}

if [ "$MIMETYPE" = 'audio' ]; then
    ARGS="--no-video"
elif [ "$MIMETYPE" = 'video' ]; then
    ARGS="--x11-name='mpvAlarm'"
else
    echo "Ringtone file not selected Audio/Video File"
    notify-send "Select Audio/Video File"
    exit 1
fi

notify
mpv --no-terminal --no-resume-playback --no-config --loop-file=5 "$ALARM"
