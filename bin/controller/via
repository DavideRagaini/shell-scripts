#!/bin/bash

CACHE="$HOME/.cache/via"

build_cache() {
	if [[ "$1" == "-r" ]] || [[ ! -e "$CACHE" ]]; then
		fd -c never -t f -E "Storage" -E "Projects" -E "Torrents" -E "Laboratorio Automazione" -E "Programmazione ad Oggetti" --base-directory "$HOME" >"$CACHE"
	fi
}

case "$1" in
-r)
	build_cache -r
	cat "$CACHE" |
		fzfmenu |
		opener ;;
-ro)
	build_cache ;;
*)
	build_cache
	cat "$CACHE" |
		fzfmenu |
		opener ;;
esac
