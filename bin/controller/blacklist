#!/bin/sh

HOSTS="${XDG_DATA_HOME:-$HOME/.local/share}/hosts.d/hosts"
HOSTS1="${XDG_DATA_HOME:-$HOME/.local/share}/hosts.d/hosts1"
HOSTS2="${XDG_DATA_HOME:-$HOME/.local/share}/hosts.d/hosts2"
SUPERHOSTS="${XDG_DATA_HOME:-$HOME/.local/share}/hosts.d/superhosts.deny"

set_hosts() {
    [ -e /etc/hosts ] ||
        (sudo ln -s "$HOSTS" "/etc/hosts" &&
            notify-send "Hosts Set")

    [ -e /etc/hosts.deny ] ||
        (sudo ln -s "$HOSTS.deny" "/etc/hosts.deny" &&
            notify-send "Hosts.deny Set")

    [ -e /etc/superhosts.deny ] ||
        (sudo ln -s "$SUPERHOSTS" "/etc/superhosts.deny" &&
            notify-send "Superhosts.deny Set")
}

case "$1" in
    on)
        set_hosts
        ;;

    update)
        echo 'Downloading hosts'
        curl -o "$HOSTS1" "https://hosts.ubuntu101.co.za/hosts"
        curl -o "$HOSTS2" 'http://sbc.io/hosts/alternates/fakenews-gambling-porn/hosts'
        cat $HOSTS1 >$HOSTS
        cat $HOSTS2 >>$HOSTS

        echo 'Downloading hosts.deny'
        curl -o "$HOSTS.deny" "https://hosts.ubuntu101.co.za/hosts.deny"

        echo 'Downloading superhosts.deny'
        curl -o "$SUPERHOSTS" "https://hosts.ubuntu101.co.za/superhosts.deny"

        set_hosts
        ;;

    *)
        echo 'Need arg!'
        ;;
esac
